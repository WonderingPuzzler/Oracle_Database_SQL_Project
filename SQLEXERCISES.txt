-- Matthew Perez
-- 5/10/24
-- ISQA 3310-001

--Query 1

select FACILITY.FAC_STREET, FACILITY.FAC_STREET_2, FACILITY.FAC_CITY, FACILITY.FAC_STATE, FACILITY.FAC_ZIP_CODE, FACILITY.FAC_RISK_LEVEL, FACILITY.FAC_OVERALL_SANITATION_RATING, POINT_OF_CONTACT.POC_FNAME, POINT_OF_CONTACT.POC_LNAME, POINT_OF_CONTACT.POC_PHONE_NUMBER 
from FACILITY 
join POINT_OF_CONTACT 
on FACILITY.FAC_ID = POINT_OF_CONTACT.FAC_ID 
where FACILITY.FAC_ID = 1;



--Query 2

select INSPECT_FIRST_NAME, INSPECT_LAST_NAME, INSPECT_HIRE_DATE, INSPECT_CERTIFICATION_DATE, INSPECT_EMAIL_ADDRESS
from INSPECTOR
where OFF_NUM = 1
order by INSPECT_CERTIFICATION_DATE;



--Query 3

select CUSTOMER.CUST_FIRST_NAME, CUSTOMER.CUST_LAST_NAME, CUSTOMER.CUST_STREET, CUSTOMER.CUST_STREET_2, CUSTOMER.CUST_CITY, CUSTOMER.CUST_STATE, CUSTOMER.CUST_ZIP_CODE, CUSTOMER.CUST_PHONE, COMPLAINT.COMP_DATE, COMPLAINT.COMP_TYPE, COMPLAINT.COMP_TEXT
from CUSTOMER
join COMPLAINT 
on CUSTOMER.CUST_ID = COMPLAINT.CUST_ID
where COMPLAINT.FAC_ID = 1
order by COMPLAINT.COMP_DATE; 



--Query 4

select FACILITY.FAC_NAME, FACILITY.FAC_STREET, FACILITY.FAC_STREET_2, FACILITY.FAC_CITY, FACILITY.FAC_STATE, FACILITY.FAC_ZIP_CODE, INSPECTION.INSP_FINAL_RATING
from FACILITY
join INSPECTION
on FACILITY.FAC_ID = INSPECTION.FAC_ID
where INSPECTION.INSP_DATE_OF_INSPECTION = '15-OCT-2023';



--Query 5

select INSPECTION.INSP_FOOD_SOURCE, INSPECTION.INSP_PROPER_FOOD_TEMP_CONTROL, INSPECTION.INSP_PERSONAL_HYGIENE, INSPECTION.INSP_CLEANING, INSPECTION.INSP_INSECT, INSPECTION.INSP_WASTE_DISPOSAL, INSPECTION.INSP_FINAL_RATING, INSPECTION.INSP_DATE_OF_INSPECTION, INSPECTION.INSP_RISK_DESCRIPTION, INSPECTION.INSPECT_ID, INSPECTION.FAC_ID, INSPECTION.OFF_NUM, FACILITY.FAC_NAME 
from INSPECTION 
join INSPECTOR 
on INSPECTION.OFF_NUM = INSPECTOR.OFF_NUM
join FACILITY
on INSPECTION.FAC_ID = FACILITY.FAC_ID 
where INSPECTOR.INSPECT_FIRST_NAME = 'Stephen'
and INSPECTOR.INSPECT_LAST_NAME = 'Rogers';



--Query 6

select FACILITY.FAC_NAME, FACILITY.FAC_STREET, FACILITY.FAC_GENERAL_TYPE, FACILITY.FAC_OVERALL_SANITATION_RATING, INSPECTION.INSP_DATE_OF_INSPECTION 
from FACILITY
join INSPECTION
on FACILITY.FAC_ID = INSPECTION.FAC_ID
where INSPECTION.INSP_DATE_OF_INSPECTION =
      (select max(INSP_DATE_OF_INSPECTION)
       from INSPECTION
       where FAC_ID = FACILITY.FAC_ID)
order by FACILITY.FAC_NAME;



--Query 7

insert into INSPECTION
values ('Superior', 'Superior', 'Superior', 'Superior', 'Superior', 'Superior', 'Superior', '17-NOV-2023', 'Perfection incarnate!', 4, 1, 3);

update FACILITY
set FAC_OVERALL_SANITATION_RATING = 'Superior'
where FAC_ID = 1;



--Query 8

select FACILITY.FAC_NAME, INSPECTOR.INSPECT_FIRST_NAME, INSPECTOR.INSPECT_LAST_NAME, FEE.FEE_INITIAL_PERMIT, FEE.FEE_FIRST_PREP_AREA, FEE.FEE_NO_FOOD_PREP_AREA, FEE.FEE_ADD_FOOD_PREP
from INSPECTION
join FACILITY 
on INSPECTION.FAC_ID = FACILITY.FAC_ID
join FEE_INSPECTION 
on INSPECTION.FAC_ID = FEE_INSPECTION.FAC_ID
join INSPECTOR 
on INSPECTION.INSPECT_ID = INSPECTOR.INSPECT_ID
join FEE 
on FEE_INSPECTION.FEE_ACTIVITY_TYPE = FEE.FEE_ACTIVITY_TYPE
where FACILITY.FAC_NAME = 'Marvel Diner' 
and INSPECTOR.INSPECT_FIRST_NAME = 'Stephen' 
and INSPECTOR.INSPECT_LAST_NAME = 'Rogers' 
and INSPECTION.INSP_DATE_OF_INSPECTION = '15-OCT-2023';



--Query 9

update Point_Of_Contact
set POC_FNAME = 'Nomore', POC_LNAME = 'NamesPlz', POC_PHONE_NUMBER = '402-000-0000'
where POC_ID = 4;



--Query 10


delete from FACILITY
where FAC_ID = 4;

delete from POINT_OF_CONTACT
where FAC_ID = 4;

delete from INSPECTION 
where FAC_ID = 4;

delete from FEE_INSPECTION
where FAC_ID = 4;

delete from COMPLAINT
where FAC_ID = 4;

delete from ILLNESS_COMPLAINT
where FAC_ID = 4;

-- It seems like I only needed the first delete from to get rid of all mentions of the fourth facility, but I thought I would be better safe than sorry, and show which tables are connected through FAC_ID
